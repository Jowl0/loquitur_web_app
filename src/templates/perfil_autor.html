{% extends 'base.html' %}

{% block titulo %}Loquitur - {{autor[0].nombre}}{% endblock %}

{% block content %}
<style>
    .profile-card-img {
        width: 100%;
        aspect-ratio: 1 / 1;
        object-fit: cover;
    }

    @media (min-width: 768px) {
        .profile-card-img {
            width: 350px;
            height: 350px;
        }
    }

    @media (max-width: 767.98px) {
        .display-6 {
            font-size: 1.4rem !important;
            line-height: 1.2;
        }
        .display-6 small {
            font-size: 0.85rem !important;
            display: inline-block;
            vertical-align: middle;
            margin-left: 0.25rem;
        }
    }

    /* === ESTILOS === */
    .overlay-gradient {
        background: linear-gradient(to top, rgba(0, 0, 0, 0.95) 0%, rgba(0, 0, 0, 0.6) 50%, transparent 100%);
    }

    .text-shadow-strong {
        text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.9);
    }

    .title-truncate {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        overflow: hidden;
        -webkit-line-clamp: 2;
    }

    .title-truncate-large {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        overflow: hidden;
        -webkit-line-clamp: 3;
    }

    @media (min-width: 992px) {
        .title-truncate { -webkit-line-clamp: 1; }
        .title-truncate-large { -webkit-line-clamp: 3; }
    }

    .card-fixed-height { height: auto; }

    .desc-truncate {
        display: -webkit-box;
        -webkit-line-clamp: 5;
        -webkit-box-orient: vertical;
        overflow: hidden;
        height: auto;
    }

    @media (min-width: 768px) {
        .card-fixed-height { height: 280px; }
        .desc-truncate { height: 125px; }
    }

    @media (max-width: 767.98px) {
        .card-fixed-height {
            height: auto !important;
            min-height: 450px !important;
        }
        .card-fixed-height .row>div:first-child {
            height: 200px !important;
            width: 100%;
        }
        .card-fixed-height .row>div:last-child {
            height: auto !important;
            padding-top: 1rem !important;
        }
        .desc-truncate { -webkit-line-clamp: 6 !important; }
    }

    .img-cover-fit {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
</style>

<div class="container-fluid px-lg-5 px-3 pt-4 pb-5">
    <div class="row justify-content-center">
        <div class="col-12">

            <div class="card border-dark mb-5 shadow-sm">
                <div class="card-body p-4 p-lg-5">
                    <div class="row g-0 gx-lg-5">

                        <div class="col-lg-auto mb-4 mb-lg-0 text-center">
                            <div class="card border-dark d-inline-block overflow-hidden">
                                <img src="/{{autor[0].imagen}}" class="profile-card-img d-block" alt="{{autor[0].nombre}}">
                            </div>
                        </div>

                        <div class="col-lg d-flex flex-column text-lg-start align-items-lg-start">
                            <h2 class="fw-bold display-6 mt-0 mb-3 d-md-flex justify-content-lg-start align-items-md-center gap-md-2 w-100">
                                <span style="line-height: 1;">{{autor[0].nombre}}</span>
                                <small class="text-muted fw-normal" style="font-size: 1rem; line-height: 1;">
                                    &bull; Miembro desde: 2024
                                </small>
                            </h2>

                            <p class="mb-4 text-muted w-100" style="font-size: 1.1rem; line-height: 1.6;">
                                {{autor[0].descripcion or 'Estudiante de la Facultad de Derecho de la UNAM, apasionado por la investigación jurídica y el análisis de casos contemporáneos. Colaborador activo en diversas publicaciones académicas.'}}
                            </p>

                            <div class="d-flex flex-row gap-4 align-items-center mt-auto justify-content-lg-start w-100">
                                <a href="mailto:{{autor[0].email or 'correo@ejemplo.com'}}" class="text-dark fs-4 text-decoration-none transition-hover" title="Email">
                                    <i class="bi bi-envelope-fill"></i>
                                </a>
                                <a href="https://instagram.com/usuario_ejemplo" target="_blank" class="text-dark fs-4 text-decoration-none transition-hover" title="Instagram">
                                    <i class="bi bi-instagram"></i>
                                </a>
                                <a href="https://linkedin.com/in/usuario_ejemplo" target="_blank" class="text-dark fs-4 text-decoration-none transition-hover" title="LinkedIn">
                                    <i class="bi bi-linkedin"></i>
                                </a>
                                <a href="https://twitter.com/usuario_ejemplo" target="_blank" class="text-dark fs-4 text-decoration-none transition-hover" title="X (Twitter)">
                                    <i class="bi bi-twitter-x"></i>
                                </a>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <h3 class="fw-bold mb-4">Artículos Publicados</h3>
            
            {% if articulos %}
                <div id="contenedor-articulos">
                    {% for art in articulos %}
                    <div class="card mb-4 border shadow-sm card-fixed-height">
                        <div class="card-body h-100 p-3">
                            <div class="row h-100">
                                <div class="col-md-3 h-100">
                                    <div class="card overflow-hidden card-custom-border h-100">
                                        <div class="card-body p-0 position-relative h-100">
                                            <img src="/{{ art.imagen }}" class="img-cover-fit" alt="{{ art.titulo }}" />
                                            <a href="{{ art.slug }}" class="stretched-link"></a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-9 h-100">
                                    <div class="d-flex flex-column h-100 ps-0 ps-md-3 pt-1 pt-md-0 gap-3">
                                        <h4 class="card-title fw-bold text-dark text-truncate m-0">{{ art.titulo }}</h4>
                                        <div class="d-flex align-items-center" style="position: relative; z-index: 2;">
                                            <small class="text-dark">{{ art.fecha }}</small>
                                        </div>
                                        <p class="card-text text-body desc-truncate m-0">{{ art.descripcion }}</p>
                                        <div class="text-end mt-auto">
                                            <a href="{{ art.slug }}" class="card-link text-decoration-none fw-bold text-dark stretched-link">
                                                Leer nota <i class="bi bi-arrow-right"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div> <div id="btn-container" class="text-center py-3">
                    <button id="btn-ver-mas" data-autor="{{autor[0].id}}" class="btn btn-dark btn-lg px-5 rounded-pill" data-url="/api/ver_mas">
                        Ver más artículos
                    </button>
                </div>
                <div id="alert-container" class="mt-3"></div>

            {% else %}
                <div class="row">
                    <div class="col-12">
                        <div class="alert alert-danger text-center p-5">
                            <p class="fs-5 mb-2"><strong>¡Lo sentimos!</strong> No se encontraron artículos publicados.</p>
                            <p><a href="/articulos" class="alert-link">Intenta recargar la página</a>.</p>
                            <div class="mt-4">
                                <img src="{{ url_for('static', filename='no_content.jpg') }}" alt="Sin contenido" class="img-fluid rounded" style="max-height: 300px; width: auto;">
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}

        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/ver_mas.js') }}"></script>

{% endblock %}